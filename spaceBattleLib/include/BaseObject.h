#ifndef BASEOBJECT_H_
#define BASEOBJECT_H_
#include <glm/vec3.hpp>
#include <glm/gtc/matrix_transform.hpp>
#include <glm/ext.hpp>
#include <glm/glm.hpp>
#include <memory>
#include <vector>
//-------------------------------------------------------------------------------------------------------
/// @author Renats Bikmajevs
/// Modified from : --
/// @note This is a base pure virtual class for scene objects. Mainly used to hide all transformation methods from the child class.
//-------------------------------------------------------------------------------------------------------
using namespace glm;
class BaseObject
{
public :
  //-----------------------------------------------------------------------------------------------------
  /// @brief Custom constructor that sets most member values.
  /// @param [in]_name The name of the created object to assign
  /// @param [in]_pos The position of the created object to assign
  /// @param [in]_rot The rotation of the created object to assign
  /// @param [in]_sc The scale of the created object to assign
  /// @note also resets the stored transformation matrix to identity
  //-----------------------------------------------------------------------------------------------------
  BaseObject(std::string _name = "SceneObject", vec3 _pos=vec3(0,0,0), vec3 _rot=vec3(0,0,0), vec3 _sc=vec3(1,1,1)):
    m_pos(_pos),
    m_rot(_rot),
    m_scale(_sc),
    m_name(_name),
    m_MVmatrix(1)
  {}
  //-----------------------------------------------------------------------------------------------------
  /// @brief Default virtual destructor.
  //-----------------------------------------------------------------------------------------------------
  virtual ~BaseObject()=default;
  //-----------------------------------------------------------------------------------------------------
  /// @brief Resets the object to defaults
  //-----------------------------------------------------------------------------------------------------
  virtual void reset() = 0;
  //-----------------------------------------------------------------------------------------------------
  /// @brief Changes the ID of this object to the input value
  //-----------------------------------------------------------------------------------------------------
  virtual void changeID (const size_t _newID);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Changes the name of this object to the input value
  //-----------------------------------------------------------------------------------------------------
  void setName(const std::string _new);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Returns the currently stored name of this object
  //-----------------------------------------------------------------------------------------------------
  std::string getName() const;
  //-----------------------------------------------------------------------------------------------------
  /// @brief Sets the parent of this object, adds this object as a child to parent
  /// @param [io]_new New parent to assign to this object
  //-----------------------------------------------------------------------------------------------------
  void setParent(BaseObject* _new);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Returns the parent of this object
  //-----------------------------------------------------------------------------------------------------
  BaseObject* getParent() const;
  //-----------------------------------------------------------------------------------------------------
  /// @brief Adds a child to the current object, adds this object as a parent to the child
  /// @brief If input pointer matches any of the existing children, it will be removed from the parent
  /// @param [io]_new New child to assign to this object
  //-----------------------------------------------------------------------------------------------------
  void addChild(BaseObject* _new);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Changes the children of the current object, also assigns this object as parent to each child
  /// @param [io]_new New children to assign to this object
  //-----------------------------------------------------------------------------------------------------
  void setChildren(std::vector<BaseObject*> _new);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Returns a vector all children of the current object
  //-----------------------------------------------------------------------------------------------------
  std::vector<BaseObject*> getChildren() const;
  //-----------------------------------------------------------------------------------------------------
  /// @brief Adds translation vector to the currently stored vector
  //-----------------------------------------------------------------------------------------------------
  void moveObject (const vec3 _tr);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Sets the position vector of this object using the input values
  //-----------------------------------------------------------------------------------------------------
  void setPosition (const vec3 _tr);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Adds rotation angles to the currently stored rotation vector, using angle-axis
  //-----------------------------------------------------------------------------------------------------
  void rotateObject (const vec3 _rot);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Sets the rotation vector of this object using input values, angle-axis
  //-----------------------------------------------------------------------------------------------------
  void setRotation (const vec3 _rot);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Adds a scale vector to the currently stored vector
  //-----------------------------------------------------------------------------------------------------
  void scaleObject (const vec3 _sc);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Sets the scale vector of this object using input values
  //-----------------------------------------------------------------------------------------------------
  void setScale (const vec3 _sc);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Returns translation(position) vector of this object
  //-----------------------------------------------------------------------------------------------------
  vec3 getPosition () const;
  //-----------------------------------------------------------------------------------------------------
  /// @brief Returns rotation (using angle-axis) vector of this object
  //-----------------------------------------------------------------------------------------------------
  vec3 getRotation () const;
  //-----------------------------------------------------------------------------------------------------
  /// @brief Returns scale vector of this object
  //-----------------------------------------------------------------------------------------------------
  vec3 getScale () const;
  //-----------------------------------------------------------------------------------------------------
  /// @brief Returns the ID of this object, pure virtual
  //-----------------------------------------------------------------------------------------------------
  virtual size_t getID () const = 0;
  //-----------------------------------------------------------------------------------------------------
  /// @brief Sets the active status switch of this object to the input value
  //-----------------------------------------------------------------------------------------------------
  void setActive(bool _new);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Returns the active status of this object
  //-----------------------------------------------------------------------------------------------------
  bool isActive();
  //-----------------------------------------------------------------------------------------------------
  /// @brief Updates the local transformation matrix, also adds parent matrix
  //-----------------------------------------------------------------------------------------------------
  void updateMatrix();
  //-----------------------------------------------------------------------------------------------------
  /// @brief Returns the local transformation matrix stored in this object
  //-----------------------------------------------------------------------------------------------------
  mat4 getMVmatrix() const;
protected :
  //-----------------------------------------------------------------------------------------------------
  /// @brief Translation/Position vector of this object
  //-----------------------------------------------------------------------------------------------------
  vec3 m_pos = glm::vec3(0,0,0);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Rotation vector of this object stored as angle-axis values
  //-----------------------------------------------------------------------------------------------------
  vec3 m_rot = glm::vec3(0,0,0);
  //-----------------------------------------------------------------------------------------------------
  /// @brief Scale vector of this object
  //-----------------------------------------------------------------------------------------------------
  vec3 m_scale = glm::vec3(1,1,1);
  //-----------------------------------------------------------------------------------------------------
  /// @brief ID of this object, gets reassigned on higner levels if already in use
  //-----------------------------------------------------------------------------------------------------
  size_t m_id=0;
  //-----------------------------------------------------------------------------------------------------
  /// @brief A poiner to the Parent of this object
  //-----------------------------------------------------------------------------------------------------
  BaseObject* m_parent = nullptr;
  //-----------------------------------------------------------------------------------------------------
  /// @brief A vector of pointers to child objects of this object
  //-----------------------------------------------------------------------------------------------------
  std::vector<BaseObject*> m_children;
  //-----------------------------------------------------------------------------------------------------
  /// @brief The Name of this object
  //-----------------------------------------------------------------------------------------------------
  std::string m_name = "SceneObject";
  //-----------------------------------------------------------------------------------------------------
  /// @brief Active/Visibility status switch, true by default
  //-----------------------------------------------------------------------------------------------------
  bool m_isActive = true;
  //-----------------------------------------------------------------------------------------------------
  /// @brief A local transformation matrix based on position, rotation and scale
  //-----------------------------------------------------------------------------------------------------
  mat4 m_MVmatrix {1};
};
#endif //BASEMESH_H_
